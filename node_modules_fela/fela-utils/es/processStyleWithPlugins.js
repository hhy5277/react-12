import arrayReduce from 'fast-loops/lib/arrayReduce'
import * as perf from '@stardust-ui/react/src/lib/perf'

const processStyleWithPlugins = perf.time('[fela] processStyleWithPlugins', function(
  renderer,
  style,
  type,
) {
  var props = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {}

  if (renderer.plugins.length > 0) {
    return arrayReduce(
      renderer.plugins,
      function(processedStyle, plugin) {
        return plugin(processedStyle, type, renderer, props)
      },
      style,
    )
  }

  return style
})

export default processStyleWithPlugins
